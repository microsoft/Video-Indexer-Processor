{
  "lenses": {
    "0": {
      "order": 0,
      "parts": {
        "0": {
          "position": {
            "x": 0,
            "y": 0,
            "colSpan": 2,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/ClockPart",
            "settings": {
              "content": {
                "settings": {
                  "timeFormat": "HH:mm",
                  "timezoneId": "UTC",
                  "version": 1
                }
              }
            }
          }
        },
        "1": {
          "position": {
            "x": 2,
            "y": 0,
            "colSpan": 10,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/MarkdownPart",
            "settings": {
              "content": {
                "settings": {
                  "content": "# Media Enrichment Search Monitoring Dashboard\n\n\n",
                  "markdownSource": 1,
                  "markdownUri": null,
                  "subtitle": "",
                  "title": ""
                }
              }
            }
          }
        },
        "2": {
          "position": {
            "x": 13,
            "y": 0,
            "colSpan": 2,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [
              {
                "name": "ComponentId",
                "value": "${appinsights_resource_id}",
                "isOptional": true
              },
              {
                "name": "TimeContext",
                "value": null,
                "isOptional": true
              },
              {
                "name": "ResourceIds",
                "value": [
                  "${appinsights_resource_id}"
                ],
                "isOptional": true
              },
              {
                "name": "ConfigurationId",
                "value": "${workbook_resource_id}",
                "isOptional": true
              },
              {
                "name": "Type",
                "value": "workbook",
                "isOptional": true
              },
              {
                "name": "GalleryResourceType",
                "value": "microsoft.insights/components",
                "isOptional": true
              },
              {
                "name": "PinName",
                "value": "Dashboard Tile Queries",
                "isOptional": true
              },
              {
                "name": "StepSettings",
                "value": "{\"version\":\"KqlItem/1.0\",\"query\":\"customEvents \\n| summarize total_queries = sumif(itemCount, name has \\\"onSearch\\\")\",\"size\":3,\"queryType\":0,\"resourceType\":\"microsoft.insights/components\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"total_queries\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"max\":10,\"palette\":\"blue\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}},\"tooltipFormat\":{\"tooltip\":\"Total Queries Submitted\"}},\"showBorder\":false,\"size\":\"auto\"}}",
                "isOptional": true
              },
              {
                "name": "ParameterValues",
                "value": {},
                "isOptional": true
              },
              {
                "name": "Location",
                "value": "eastus",
                "isOptional": true
              }
            ],
            "type": "Extension/AppInsightsExtension/PartType/PinnedNotebookQueryPart",
            "partHeader": {
              "title": "Total Queries",
              "subtitle": "Submitted queries"
            }
          }
        },
        "3": {
          "position": {
            "x": 15,
            "y": 0,
            "colSpan": 2,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [
              {
                "name": "ComponentId",
                "value": "${appinsights_resource_id}",
                "isOptional": true
              },
              {
                "name": "TimeContext",
                "value": null,
                "isOptional": true
              },
              {
                "name": "ResourceIds",
                "value": [
                  "${appinsights_resource_id}"
                ],
                "isOptional": true
              },
              {
                "name": "ConfigurationId",
                "value": "${workbook_resource_id}",
                "isOptional": true
              },
              {
                "name": "Type",
                "value": "workbook",
                "isOptional": true
              },
              {
                "name": "GalleryResourceType",
                "value": "microsoft.insights/components",
                "isOptional": true
              },
              {
                "name": "PinName",
                "value": "Dashboard Tile Queries",
                "isOptional": true
              },
              {
                "name": "StepSettings",
                "value": "{\"version\":\"KqlItem/1.0\",\"query\":\"customEvents \\n| summarize total_sessions = dcountif(session_Id, name has \\\"onSearch\\\")\",\"size\":3,\"color\":\"blue\",\"queryType\":0,\"resourceType\":\"microsoft.insights/components\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"total_sessions\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"max\":10,\"palette\":\"blue\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}},\"tooltipFormat\":{\"tooltip\":\"Total Number of User Sessions\"}},\"showBorder\":false,\"size\":\"auto\"}}",
                "isOptional": true
              },
              {
                "name": "ParameterValues",
                "value": {},
                "isOptional": true
              },
              {
                "name": "Location",
                "value": "eastus",
                "isOptional": true
              }
            ],
            "type": "Extension/AppInsightsExtension/PartType/PinnedNotebookQueryPart",
            "partHeader": {
              "title": "Total Sessions",
              "subtitle": "Unique user sessions"
            }
          }
        },
        "4": {
          "position": {
            "x": 17,
            "y": 0,
            "colSpan": 2,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [
              {
                "name": "ComponentId",
                "value": "${appinsights_resource_id}",
                "isOptional": true
              },
              {
                "name": "TimeContext",
                "value": null,
                "isOptional": true
              },
              {
                "name": "ResourceIds",
                "value": [
                  "${appinsights_resource_id}"
                ],
                "isOptional": true
              },
              {
                "name": "ConfigurationId",
                "value": "${workbook_resource_id}",
                "isOptional": true
              },
              {
                "name": "Type",
                "value": "workbook",
                "isOptional": true
              },
              {
                "name": "GalleryResourceType",
                "value": "microsoft.insights/components",
                "isOptional": true
              },
              {
                "name": "PinName",
                "value": "Dashboard Tile Queries",
                "isOptional": true
              },
              {
                "name": "StepSettings",
                "value": "{\"version\":\"KqlItem/1.0\",\"query\":\"customEvents \\n| summarize dcount(user_Id)\",\"size\":3,\"color\":\"blue\",\"queryType\":0,\"resourceType\":\"microsoft.insights/components\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"dcount_user_Id\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"max\":10,\"palette\":\"blue\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"}},\"tooltipFormat\":{\"tooltip\":\"Total Number of Users\"}},\"showBorder\":false,\"size\":\"auto\"}}",
                "isOptional": true
              },
              {
                "name": "ParameterValues",
                "value": {},
                "isOptional": true
              },
              {
                "name": "Location",
                "value": "eastus",
                "isOptional": true
              }
            ],
            "type": "Extension/AppInsightsExtension/PartType/PinnedNotebookQueryPart",
            "partHeader": {
              "title": "Total Users",
              "subtitle": "Unique users performing searches"
            }
          }
        },
        "5": {
          "position": {
            "x": 19,
            "y": 0,
            "colSpan": 2,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [
              {
                "name": "ComponentId",
                "value": "${appinsights_resource_id}",
                "isOptional": true
              },
              {
                "name": "TimeContext",
                "value": null,
                "isOptional": true
              },
              {
                "name": "ResourceIds",
                "value": [
                  "${appinsights_resource_id}"
                ],
                "isOptional": true
              },
              {
                "name": "ConfigurationId",
                "value": "${workbook_resource_id}",
                "isOptional": true
              },
              {
                "name": "Type",
                "value": "workbook",
                "isOptional": true
              },
              {
                "name": "GalleryResourceType",
                "value": "microsoft.insights/components",
                "isOptional": true
              },
              {
                "name": "PinName",
                "value": "Dashboard Tile Queries",
                "isOptional": true
              },
              {
                "name": "StepSettings",
                "value": "{\"version\":\"KqlItem/1.0\",\"query\":\"customEvents \\n| summarize total_success = dcountif(session_Id, name has \\\"onCopy\\\") , total_sessions = dcountif(session_Id, name has \\\"onSearch\\\")\\n| project todouble(total_success)/todouble(total_sessions)\",\"size\":3,\"color\":\"blue\",\"queryType\":0,\"resourceType\":\"microsoft.insights/components\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"Column1\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"max\":80,\"palette\":\"redGreen\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"percent\"}},\"tooltipFormat\":{\"tooltip\":\"Successful Sessions / Total Sessions\"}},\"showBorder\":false,\"size\":\"auto\"}}",
                "isOptional": true
              },
              {
                "name": "ParameterValues",
                "value": {},
                "isOptional": true
              },
              {
                "name": "Location",
                "value": "eastus",
                "isOptional": true
              }
            ],
            "type": "Extension/AppInsightsExtension/PartType/PinnedNotebookQueryPart",
            "partHeader": {
              "title": "Successful Session Rate",
              "subtitle": "Session Ending with Success"
            }
          }
        },
        "6": {
          "position": {
            "x": 21,
            "y": 0,
            "colSpan": 2,
            "rowSpan": 2
          },
          "metadata": {
            "inputs": [
              {
                "name": "ComponentId",
                "value": "${appinsights_resource_id}",
                "isOptional": true
              },
              {
                "name": "TimeContext",
                "value": null,
                "isOptional": true
              },
              {
                "name": "ResourceIds",
                "value": [
                  "${appinsights_resource_id}"
                ],
                "isOptional": true
              },
              {
                "name": "ConfigurationId",
                "value": "${workbook_resource_id}",
                "isOptional": true
              },
              {
                "name": "Type",
                "value": "workbook",
                "isOptional": true
              },
              {
                "name": "GalleryResourceType",
                "value": "microsoft.insights/components",
                "isOptional": true
              },
              {
                "name": "PinName",
                "value": "Dashboard Tile Queries",
                "isOptional": true
              },
              {
                "name": "StepSettings",
                "value": "{\"version\":\"KqlItem/1.0\",\"query\":\"let ranks = customEvents\\n| where  name == 'onNavigate' \\n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\\n| distinct session_Id , queryId, videoId, rankPosition;\\n\\ncustomEvents\\n| where   name == 'onCopy' \\n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\\n| project queryId, videoId,timestamp\\n| join kind=inner ranks on queryId and videoId\\n| summarize ReciprocalRank  =  arg_max(1.0 / (rankPosition), 1.0 / (rankPosition), *) \\nby session_Id, queryId, Date = format_datetime(timestamp, 'yy-MM-dd')\\n|summarize iif(isnan(avg(ReciprocalRank)),0.0, avg(ReciprocalRank))\",\"size\":3,\"color\":\"blue\",\"queryType\":0,\"resourceType\":\"microsoft.insights/components\",\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{},\"leftContent\":{\"columnMatch\":\"Column1\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"max\":1,\"palette\":\"redGreen\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\"},\"emptyValCustomText\":\"0\"},\"tooltipFormat\":{\"tooltip\":\"Mean Reciprocal Rank\"}},\"showBorder\":false,\"size\":\"auto\"}}",
                "isOptional": true
              },
              {
                "name": "ParameterValues",
                "value": {},
                "isOptional": true
              },
              {
                "name": "Location",
                "value": "eastus",
                "isOptional": true
              }
            ],
            "type": "Extension/AppInsightsExtension/PartType/PinnedNotebookQueryPart",
            "partHeader": {
              "title": "Mean Reciprocal Rank",
              "subtitle": "https://machinelearning.wtf/terms/mean-reciprocal-rank-mrr/"
            }
          }
        },
        "7": {
          "position": {
            "x": 0,
            "y": 2,
            "colSpan": 12,
            "rowSpan": 1
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/MarkdownPart",
            "settings": {
              "content": {
                "settings": {
                  "content": "## Search Performance",
                  "markdownSource": 1,
                  "subtitle": "",
                  "title": ""
                }
              }
            }
          }
        },
        "8": {
          "position": {
            "x": 13,
            "y": 2,
            "colSpan": 10,
            "rowSpan": 1
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/MarkdownPart",
            "settings": {
              "content": {
                "settings": {
                  "content": "## Search Monitoring",
                  "markdownSource": 1,
                  "subtitle": "",
                  "title": ""
                }
              }
            }
          }
        },
        "9": {
          "position": {
            "x": 0,
            "y": 3,
            "colSpan": 12,
            "rowSpan": 5
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "19580958-4f50-40e2-b213-171ef39b7e3f",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P1D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents\n| where customDimensions.query == \"They is playing a game\"\n| where customDimensions.session == \"288044\"\n| summarize arg_max(1.0/customDimensions.position, 1.0/customDimensions.position, *) by tostring(customDimensions.session), tostring(customDimensions.query)\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-dev-o5p6",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "ControlType": "FrameControlChart",
                "Dimensions": {
                  "aggregation": "Sum",
                  "splitBy": [],
                  "xAxis": {
                    "name": "Date",
                    "type": "datetime"
                  },
                  "yAxis": [
                    {
                      "name": "Daily Mean RR",
                      "type": "real"
                    }
                  ]
                },
                "IsQueryContainTimeRange": true,
                "LegendOptions": {
                  "isEnabled": true,
                  "position": "Bottom"
                },
                "PartTitle": "Reciprocal Rank ",
                "Query": "let ranks = customEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onNavigate' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| distinct session_Id , queryId, videoId, rankPosition;\ncustomEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onCopy' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| project queryId, videoId,timestamp\n| join kind=inner ranks on queryId and videoId\n| summarize ReciprocalRank =  arg_max(1.0 / (rankPosition), 1.0 / (rankPosition), *) \n    by session_Id, queryId, Date = format_datetime(timestamp, 'yyyy-MM-dd')\n| where isnotnull(ReciprocalRank)\n| make-series [\"Daily Mean RR\"] = avg(ReciprocalRank) default=0 on todatetime(Date) step 1d\n| render timechart with (ymin=0, ymax=1)\n\n",
                "SpecificChart": "Line"
              }
            },
            "partHeader": {
              "title": "Daily Reciprocal Rank",
              "subtitle": "Mean RR across all daily queries"
            }
          }
        },
        "10": {
          "position": {
            "x": 13,
            "y": 3,
            "colSpan": 10,
            "rowSpan": 5
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "10513a33-85f4-4477-ad3c-9c2f578038a8",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P7D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents\n| where name has \"[waldo], Copy to USN\"\n| summarize dcount(tostring(customDimensions.sessionId)) by format_datetime(todatetime(customDimensions.mock_timestamp), 'yy-MM-dd')\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-dev-o5p6",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "Query": "customEvents\n| make-series [\"Total Sessions\"] = dcountif(session_Id, name has \"onSearch\") default=0 on timestamp step 1d\n| render timechart \n| project-rename Date = timestamp\n\n",
                "ControlType": "FrameControlChart",
                "SpecificChart": "Line",
                "PartTitle": "Number of sessions per day",
                "Dimensions": {
                  "xAxis": {
                    "name": "Date",
                    "type": "datetime"
                  },
                  "yAxis": [
                    {
                      "name": "Total Sessions",
                      "type": "real"
                    }
                  ],
                  "splitBy": [],
                  "aggregation": "Sum"
                },
                "LegendOptions": {
                  "isEnabled": true,
                  "position": "Bottom"
                },
                "IsQueryContainTimeRange": true
              }
            },
            "partHeader": {
              "title": "Daily Session Count",
              "subtitle": "Number of daily user sessions"
            }
          }
        },
        "11": {
          "position": {
            "x": 0,
            "y": 8,
            "colSpan": 12,
            "rowSpan": 4
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "154c5d4d-4f48-4d1e-8414-470c04b67211",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "let ranks = customEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onNavigate' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| summarize watched_videos = dcount(videoId) by session_Id, queryId, Date = format_datetime(timestamp, 'yyyy-MM-dd');\ncustomEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onCopy' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| summarize copied_videos = dcount(videoId) by session_Id, queryId, Date = format_datetime(timestamp, 'yyyy-MM-dd')\n| join kind=rightouter ranks on queryId, session_Id, Date\n| extend num_copied_videos = iff(isnull(copied_videos), 0, copied_videos)\n| extend copied_over_watched = todouble(num_copied_videos) / watched_videos\n| make-series [\"Copied over Navigated (%)\"] = avg(copied_over_watched) * 100 default=0 on todatetime(Date) step 1d\n| render timechart with (ymin=0, ymax=100)\n\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-stg-9ki9",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": true,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {},
            "partHeader": {
              "title": "Successful over Watched Rate",
              "subtitle": "videos with success feedback / watched videos"
            }
          }
        },
        "12": {
          "position": {
            "x": 13,
            "y": 8,
            "colSpan": 10,
            "rowSpan": 5
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "2350522a-3fb8-400c-9888-63b4a666d646",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P1D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents\n| where name has \"[waldo], Copy to USN\"\n//| where customDimensions.session == \"288044\"\n| summarize ReciprocalRank =  arg_max(1.0 / (customDimensions.index_rank + 1), 1.0 / (customDimensions.index_rank + 1), *) \n    by\n    tostring(customDimensions.sessionId),\n    tostring(customDimensions.correlationId),\n    format_datetime(timestamp, 'yy-MM-dd')\n| sort by timestamp asc\n\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-dev-o5p6",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "ControlType": "FrameControlChart",
                "Dimensions": {
                  "aggregation": "Sum",
                  "splitBy": [],
                  "xAxis": {
                    "name": "Date",
                    "type": "datetime"
                  },
                  "yAxis": [
                    {
                      "name": "avg_queries_per_session",
                      "type": "real"
                    }
                  ]
                },
                "LegendOptions": {
                  "isEnabled": true,
                  "position": "Bottom"
                },
                "Query": "customEvents\n| where name==\"onSearch\"\n| summarize num_queries = dcount(tostring(customDimensions.queryId)) by Date = format_datetime(timestamp, 'yyyy-MM-dd'), session_Id\n| make-series avg_queries_per_session = avg(num_queries) on todatetime(Date) step 1d\n| render timechart\n\n",
                "SpecificChart": "Line"
              }
            },
            "partHeader": {
              "title": "Daily Number of Queries per Session",
              "subtitle": "Daily Rate"
            }
          }
        },
        "13": {
          "position": {
            "x": 0,
            "y": 12,
            "colSpan": 6,
            "rowSpan": 1
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/MarkdownPart",
            "settings": {
              "content": {
                "settings": {
                  "content": "<h2><span style=\"text-decoration:\">\n<span style=\"color:#C21E56\">&#9660; </span>\n Bottom 20 Queries with Lowest Reciprocal Rank&nbsp;</span></h2>\n",
                  "markdownSource": 1,
                  "markdownUri": null,
                  "subtitle": "",
                  "title": ""
                }
              }
            }
          }
        },
        "14": {
          "position": {
            "x": 6,
            "y": 12,
            "colSpan": 6,
            "rowSpan": 1
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/MarkdownPart",
            "settings": {
              "content": {
                "settings": {
                  "content": "<h2><span style=\"text-decoration:\"><span style>\n<span style=\"color:#7A9D3B\">&#9650; </span>\nTop 20 Queries with Highest Reciprocal Rank&nbsp;</span></span></h2>",
                  "markdownSource": 1,
                  "markdownUri": null,
                  "subtitle": "",
                  "title": ""
                }
              }
            }
          }
        },
        "15": {
          "position": {
            "x": 0,
            "y": 13,
            "colSpan": 6,
            "rowSpan": 6
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "13a1000d-16cc-490b-817d-1d9ad597d630",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P1D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents\n| where name has \"[waldo], Copy to USN\"\n| summarize ReciprocalRank =  arg_max(1.0 / (customDimensions.index_rank + 1), 1.0 / (customDimensions.index_rank + 1), *) \n    by\n    tostring(customDimensions.sessionId),\n    tostring(customDimensions.correlationId),\n    tostring(customDimensions.query),\n    format_datetime(timestamp, 'yy-MM-dd')\n// | sort by ReciprocalRank asc\n|project timestamp, customDimensions_sessionId, customDimensions_correlationId, customDimensions.query, ReciprocalRank\n| top 10 by ReciprocalRank asc\n\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-dev-o5p6",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "IsQueryContainTimeRange": true,
                "Query": "let ranks = customEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onNavigate' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| distinct session_Id , queryId, videoId, rankPosition;\ncustomEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onCopy' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| project queryId, videoId,timestamp\n| join kind=inner ranks on queryId and videoId\n| summarize ReciprocalRank =  arg_max(1.0 / rankPosition, 1.0 / rankPosition, *) \n    by session_Id, queryId, Date = format_datetime(timestamp, 'yyyy-MM-dd')\n| where isnotnull(ReciprocalRank)\n| project timestamp, queryId, ReciprocalRank\n| top 20 by ReciprocalRank asc\n| join kind=inner (customEvents\n    | where name == 'onSearch'\n    | project queryId = tostring(customDimensions.queryId), Query = tostring(customDimensions.query))\n        on queryId\n| distinct timestamp, Query, ReciprocalRank, queryId\n| sort by ReciprocalRank asc, timestamp desc\n\n"
              }
            },
            "partHeader": {
              "title": "Lowest 20 RR Queries",
              "subtitle": ""
            }
          }
        },
        "16": {
          "position": {
            "x": 6,
            "y": 13,
            "colSpan": 6,
            "rowSpan": 6
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "34fbd8c5-59a2-42ab-b744-404350134f6e",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P1D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents\n| where name has \"[waldo], Copy to USN\"\n| summarize ReciprocalRank =  arg_max(1.0 / (customDimensions.index_rank + 1), 1.0 / (customDimensions.index_rank + 1), *) \n    by\n    tostring(customDimensions.sessionId),\n    tostring(customDimensions.correlationId),\n    tostring(customDimensions.query),\n    format_datetime(timestamp, 'yy-MM-dd')\n// | sort by ReciprocalRank asc\n|project timestamp, customDimensions_sessionId, customDimensions_correlationId, customDimensions.query, ReciprocalRank\n| top 10 by ReciprocalRank desc\n\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-dev-o5p6",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "IsQueryContainTimeRange": true,
                "Query": "let ranks = customEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onNavigate' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| distinct session_Id , queryId, videoId, rankPosition;\ncustomEvents\n| where timestamp >= datetime(2022-06-22 16:00:00) and name == 'onCopy' \n| extend queryId=tostring(customDimensions.queryId), videoId=tostring(customDimensions.videoId), rankPosition=toint(customDimensions.rankPosition)\n| project queryId, videoId,timestamp\n| join kind=inner ranks on queryId and videoId\n| summarize ReciprocalRank =  arg_max(1.0 / rankPosition, 1.0 / rankPosition, *) \n    by session_Id, queryId, Date = format_datetime(timestamp, 'yyyy-MM-dd')\n| where isnotnull(ReciprocalRank)\n| project timestamp, queryId, ReciprocalRank\n| top 20 by ReciprocalRank desc \n| join kind=inner (customEvents\n    | where name == 'onSearch'\n    | project queryId = tostring(customDimensions.queryId), Query = tostring(customDimensions.query))\n        on queryId\n| distinct timestamp, Query, ReciprocalRank, queryId\n| sort by ReciprocalRank desc, timestamp desc\n\n"
              }
            },
            "partHeader": {
              "title": "Top 20 RR Queries",
              "subtitle": ""
            }
          }
        },
        "17": {
          "position": {
            "x": 13,
            "y": 13,
            "colSpan": 6,
            "rowSpan": 5
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "1426b094-7b3f-4791-b21c-133f5f57956a",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P3D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents \n| where name == 'onSearch'\n| project timestamp, customDimensions.query\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "GridColumnsWidth": {
                  "Query": "185.999px",
                  "query_id": "211px"
                },
                "Query": "customEvents \n| where name == 'onSearch'\n| summarize timestamp = min(timestamp) by Query = tostring(customDimensions.query), query_id = tostring(customDimensions.queryId)\n| project  timestamp, Query, query_id\n| sort by timestamp desc\n\n"
              }
            },
            "partHeader": {
              "title": "Latest Searched User Queries",
              "subtitle": "Look at Searches performed"
            }
          }
        },
        "18": {
          "position": {
            "x": 19,
            "y": 13,
            "colSpan": 4,
            "rowSpan": 5
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "353673ab-2686-4d39-a13e-2564f5106d30",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P3D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents \n| where name == 'onSearch'\n| summarize [\"Query Count\"] = sum(itemCount) by Query = tostring(customDimensions.query)\n| order by [\"Query Count\"] desc\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "Query": "customEvents \n| where name == 'onSearch'\n| summarize [\"Query Count\"] = dcount(tostring(customDimensions.queryId)) by Query = tostring(customDimensions.query)\n| order by [\"Query Count\"] desc\n\n"
              }
            },
            "partHeader": {
              "title": "Top Searched Queries",
              "subtitle": ""
            }
          }
        },
        "19": {
          "position": {
            "x": 0,
            "y": 19,
            "colSpan": 6,
            "rowSpan": 1
          },
          "metadata": {
            "inputs": [],
            "type": "Extension/HubsExtension/PartType/MarkdownPart",
            "settings": {
              "content": {
                "settings": {
                  "content": "<h2><span style=\"text-decoration:;font-size:22px\">\n<span style=\"color:#D3A94B\">&#9888; </span>\nQueries with no Copy USN&nbsp;</span></h2>\n",
                  "markdownSource": 1,
                  "markdownUri": null,
                  "subtitle": "",
                  "title": ""
                }
              }
            }
          }
        },
        "20": {
          "position": {
            "x": 0,
            "y": 20,
            "colSpan": 6,
            "rowSpan": 6
          },
          "metadata": {
            "inputs": [
              {
                "name": "resourceTypeMode",
                "isOptional": true
              },
              {
                "name": "ComponentId",
                "isOptional": true
              },
              {
                "name": "Scope",
                "value": {
                  "resourceIds": [
                    "${appinsights_resource_id}"
                  ]
                },
                "isOptional": true
              },
              {
                "name": "PartId",
                "value": "13a1000d-16cc-490b-817d-1d9ad597d630",
                "isOptional": true
              },
              {
                "name": "Version",
                "value": "2.0",
                "isOptional": true
              },
              {
                "name": "TimeRange",
                "value": "P1D",
                "isOptional": true
              },
              {
                "name": "DashboardId",
                "isOptional": true
              },
              {
                "name": "DraftRequestParameters",
                "isOptional": true
              },
              {
                "name": "Query",
                "value": "customEvents\n| where name has \"[waldo], Copy to USN\"\n| summarize ReciprocalRank =  arg_max(1.0 / (customDimensions.index_rank + 1), 1.0 / (customDimensions.index_rank + 1), *) \n    by\n    tostring(customDimensions.sessionId),\n    tostring(customDimensions.correlationId),\n    tostring(customDimensions.query),\n    format_datetime(timestamp, 'yy-MM-dd')\n// | sort by ReciprocalRank asc\n|project timestamp, customDimensions_sessionId, customDimensions_correlationId, customDimensions.query, ReciprocalRank\n| top 10 by ReciprocalRank asc\n\n",
                "isOptional": true
              },
              {
                "name": "ControlType",
                "value": "AnalyticsGrid",
                "isOptional": true
              },
              {
                "name": "SpecificChart",
                "isOptional": true
              },
              {
                "name": "PartTitle",
                "value": "Analytics",
                "isOptional": true
              },
              {
                "name": "PartSubTitle",
                "value": "appinsights-dev-o5p6",
                "isOptional": true
              },
              {
                "name": "Dimensions",
                "isOptional": true
              },
              {
                "name": "LegendOptions",
                "isOptional": true
              },
              {
                "name": "IsQueryContainTimeRange",
                "value": false,
                "isOptional": true
              }
            ],
            "type": "Extension/Microsoft_OperationsManagementSuite_Workspace/PartType/LogsDashboardPart",
            "settings": {
              "content": {
                "Query": "customEvents\n| summarize has_copy = sumif(itemCount, name has \"onNavigate\") by query_id = tostring(customDimensions.queryId)\n| where has_copy== 0\n| join kind=inner (customEvents\n        | where name == 'onSearch'\n        | project timestamp, query_id = tostring(customDimensions.queryId), Query  = tostring(customDimensions.query))\n        on $left.query_id == $right.query_id\n| distinct timestamp, Query, query_id\n| sort by timestamp desc\n\n"
              }
            },
            "partHeader": {
              "title": "Queries With no Copy USN Operartion",
              "subtitle": ""
            }
          }
        }
      }
    }
  },
  "metadata": {
    "model": {
      "timeRange": {
        "value": {
          "relative": {
            "duration": 24,
            "timeUnit": 1
          }
        },
        "type": "MsPortalFx.Composition.Configuration.ValueTypes.TimeRange"
      },
      "filterLocale": {
        "value": "en-us"
      },
      "filters": {
        "value": {
          "MsPortalFx_TimeRange": {
            "model": {
              "format": "utc",
              "granularity": "auto",
              "relative": "7d"
            },
            "displayCache": {
              "name": "UTC Time",
              "value": "Past 7 days"
            },
            "filteredPartIds": [
            ]
          }
        }
      }
    }
  }
}